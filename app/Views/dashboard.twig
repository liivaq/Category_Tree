{% extends "layout.twig" %}
{% import 'components/section.twig' as sectionsTemplate %}

{% block content %}
    <div>
        <button id="showCreate" class="mb-6 bg-sky-600 hover:bg-sky-400 text-white font-bold py-2 px-4 rounded focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                >
          Add a new section
        </button>
        {% include 'sections/create.twig' %} {# Include the sub_template.twig file #}

    </div>

    <div class="">
        {% macro renderSections(sections) %}
            {% for section in sections %}
                <div class="mx-auto bg-white p-8 border rounded shadow mb-4">
                    <h2 class="font-semibold text-lg">{{ section.getTitle() }}</h2>
                    <p class="mb-4">{{ section.getDescription() }}</p>
                    <input type="hidden" value="{{ section.getId() }}"/>
                    <div class="space-x-4 flex">
                        <a href="/section/add/{{ section.getId() }}">
                            <button class="bg-sky-600 hover:bg-sky-400 text-white font-bold py-2 px-4 rounded focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                Add sub-section
                            </button>
                        </a>
                        <a href="/section/edit/{{ section.getId() }}">
                            <button class="bg-amber-600 hover:bg-amber-400 text-white font-bold py-2 px-4 rounded focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                Edit
                            </button>
                        </a>
                        <form action="/section/delete/{{ section.getId() }}" method="POST">
                            <button class="bg-red-600 hover:bg-red-400 text-white font-bold py-2 px-4 rounded focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                Delete
                            </button>
                        </form>
                    </div>
                    {% if section.getChildren() is not empty %}
                        <div class="ml-8">
                            {{ _self.renderSections(section.getChildren()) }}
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
        {% endmacro %}

        {{ _self.renderSections(sections) }}
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const showFormBtn = document.getElementById('showCreate');
            const myFormSection = document.getElementById('create');

            // Add click event listener to the button
            showFormBtn.addEventListener('click', function() {
                // Toggle the visibility of the form section using the 'hidden' class
                myFormSection.classList.toggle('hidden');
            });
        });
    </script>
{% endblock %}